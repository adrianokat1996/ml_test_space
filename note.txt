Revised Experiment Plan
Aggregate Coverage Data to Daily Frequency

Transform raw coverage data into daily aggregates to ensure consistent time intervals for analysis.
Feature Selection and Model Training

Select relevant features from the dataset.
Train a simple regression model using the selected features.
Use 2024 Data as Training Set

Restrict the training data to records from the year 2024 to capture recent patterns.
Generate Predictions on Training Data

Apply the trained model to the 2024 dataset to produce prediction outputs.
Save both the input features and predicted values for further analysis.
Merge Predictions with Event Data

Integrate the prediction results with external event data (e.g., news, campaigns, disruptions) based on date alignment.
Analyze Event Impact

Investigate how specific events correlate with deviations in prediction accuracy or coverage trends.
Identify patterns or anomalies that suggest causal relationships.

df = df.withColumn("days_ago", F.datediff(F.lit(F.current_date()), F.col("date")))
df = df.withColumn("weight", F.exp(-F.col("days_ago") / 180)) # 半年衰减
assembler = VectorAssembler(inputCols=["feature1"], outputCol="features")
df_assembled = assembler.transform(df)# 训练带权重的 
XGBoostxgb = XGBoostRegressor(    
featuresCol="features",    
labelCol="label", 
weightCol="weight",  # 关键参数：指定权重列   
 maxDepth=6,   
 numRound=100)
model = xgb.fit(df_assembled)